# 1 数据集

小样本学习的关键在于相关模型在呈现新类别时的泛化能力。因此，具有大量对象类别的高多样性数据集对于训练可以检测看不见的对象的通用模型以及执行令人信服的评估是必要的。然而，现有的数据集 [13, 52, 53, 54, 55] 包含非常有限的类别，并且它们不是在少样本评估设置中设计的。因此，我们构建了一个新的小样本目标检测数据集。数据集构建。我们从现有的用于监督学习的大规模对象检测数据集构建我们的数据集，即 [54, 56]。然而，这些数据集不能直接使用，因为 1）不同数据集的标签系统不一致，其中一些具有相同语义的对象在数据集中用不同的词注释； 2）由于标签不准确和丢失，重复框，对象太大，现有注释的大部分是嘈杂的； 3）他们的训练/测试分割包含相同的类别，而对于少数样本设置，我们希望训练/测试集包含不同的类别，以评估其在未见类别上的普遍性。

要开始构建数据集，我们首先从 [54, 56] 中总结一个标签系统。我们将叶子标签合并到其原始标签树中，将具有相同语义的标签（例如，冰熊和北极熊）归为一个类别，并删除不属于任何叶子类别的语义。然后，我们删除标签质量差的图像和尺寸不正确的图像。具体来说，移除的图像具有小于图像大小 0.05% 的框，这些框通常视觉质量较差，不适合用作支持示例。接下来，我们按照few-shot learning设置将我们的数据分成训练集和测试集，没有重叠的类别。我们使用 MS COCO 数据集 [13] 中的类别构建训练集，以防研究人员更喜欢预训练阶段。然后，我们通过选择与现有训练类别距离最大的类别来拆分包含 200 个类别的测试集，其中距离是连接 is-a 分类法中两个短语含义的最短路径 [57]。其余类别合并到总共包含 800 个类别的训练集中。总之，我们构建了一个包含 1000 个类别的数据集，其中包含明确的类别拆分用于训练和测试，其中 531 个类别来自 ImageNet 数据集 [56]，469 个类别来自 Open Image 数据集 [54]。

数据集分析。我们的数据集专为小样本学习和评估模型在新类别上的通用性而设计，其中包含 1000 个类别，分别用于训练和测试集的 800/200 分割，总共约 66,000 张图像和 182,000 个边界框。详细统计数据见表 1 和图 3。我们的数据集具有以下属性：

![image-20221011143304424](https://ether-bucket-nj.oss-cn-nanjing.aliyuncs.com/img/image-20221011143304424.png)

表1. 数据集摘要: 我们的数据集在盒子大小和长宽比方面有很大的差异。

![图3。FSOD 的数据集统计。分类图像的数目几乎是平均分布的。大多数类(超过90%)有少量或中等数量的图像(在[22,108]中) ，最常见的类仍然不超过208个图像。](https://ether-bucket-nj.oss-cn-nanjing.aliyuncs.com/img/image-20221011142610087.png)

图3。FSOD 的数据集统计。分类图像的数目几乎是平均分布的。大多数类(超过90%)有少量或中等数量的图像(在[22,108]中) ，最常见的类仍然不超过208个图像。

类别的高度多样性：我们的数据集包含 83 个父语义，例如哺乳动物、服装、武器等，这些语义进一步分为 1000 个叶类别。我们的标签树如图 2 所示。由于我们严格的数据集拆分，我们的训练/测试集包含非常不同的语义类别的图像，因此对要评估的模型提出了挑战。

![图2。数据集标签树。ImageNet 类别(红色圆圈)与采用超类的 Open Image 类别(绿色圆圈)合并。](https://ether-bucket-nj.oss-cn-nanjing.aliyuncs.com/img/image-20221011142545415.png)

图2。数据集标签树。ImageNet 类别(红色圆圈)与采用超类的 Open Image 类别(绿色圆圈)合并。

具有挑战性的设置：我们的数据集包含在框大小和纵横比方面具有较大差异的对象，由 26.5% 的图像组成，测试集中不少于三个对象。我们的测试集包含大量未包含在我们的标签系统中的类别框，因此对小样本模型提出了巨大挑战。

# 2 问题定义

给定一个具有目标对象特写的支持图像 sc 和一个可能包含支持类别 c 的对象的查询图像 qc，任务是在查询中找到属于支持类别的所有目标对象，并用严格的边界框标记它们。如果支持集包含 N 个类别和每个类别的 K 示例，则该问题被称为N-way K-shot检测。

support含有N类，每个类别含有K个实例

query不限，只需要在N类中

# 3 数据集读取

## 3.1 support

- N类, 每类K个实例
- 预处理
  - 16padding裁剪, 填充0
  - resize(320, 320)

## 3.2 query

- 短边调整为600像素
- 长边上限1000

## 3.3 数据集划分

FSOD

训练集: 800类

测试集: 200类

## 3.4 训练策略

### 3.4.1 简单策略

构造训练对: $(q_c, s_c)$

### 3.4.2 另一种策略

三元组$(q_c,  s_c. s_n), c \neq n$

# 4 训练步骤

## 4.1 二元组训练

1. 特征提取
2. 对$q_c$提出roi
3. 对每个roi, 进行得分计算